<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>NBA Info Hub</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #121212;
      color: #fff;
      margin: 0;
      padding: 20px;
    }
    h1, h2 {
      text-align: center;
      color: #ff69b4;
      margin-bottom: 15px;
    }
    #search {
      display: block;
      margin: 0 auto 30px auto;
      padding: 10px;
      width: 300px;
      border-radius: 5px;
      border: none;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 30px;
    }
    .card {
      background: #00ffff20;
      border-radius: 15px;
      padding: 15px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      transition: transform 0.2s;
    }
    .card:hover {
      transform: scale(1.05);
      background: #00ffff40;
    }
    .top-card {
      background: #ff69b420;
      font-weight: bold;
      padding: 15px;
      border-radius: 15px;
      text-align: center;
    }
    .card span {
      margin: 5px 0;
    }
    .section {
      margin-bottom: 40px;
    }
  </style>
</head>
<body>

<h1>NBA Info Hub</h1>
<input type="text" id="search" placeholder="Search players, teams, or positions">

<div class="section">
  <h2>Top Performers</h2>
  <div id="top-performers" class="grid"></div>
</div>

<div class="section">
  <h2>Recent Games</h2>
  <div id="games" class="grid"></div>
</div>

<div class="section">
  <h2>All Players</h2>
  <div id="players" class="grid"></div>
</div>

<div class="section">
  <h2>Teams</h2>
  <div id="teams" class="grid"></div>
</div>

<div class="section">
  <h2>Standings</h2>
  <div id="standings" class="grid"></div>
</div>

<script>
let allPlayers = {};
let allTeams = {};

// Fetch NBA players correctly
async function fetchPlayers() {
  try {
    const res = await fetch('https://api.sleeper.app/v1/players/nba');
    const data = await res.json();
    allPlayers = Object.values(data)
      .filter(p => p.first_name && p.last_name)
      .sort((a,b)=> a.last_name.localeCompare(b.last_name)); // sort alphabetically
    displayPlayers(allPlayers);
  } catch(err) { console.error(err); }
}

// Display all players as cards
function displayPlayers(players) {
  const container = document.getElementById('players');
  container.innerHTML = '';
  players.forEach(p => {
    const div = document.createElement('div');
    div.className = 'card';
    div.innerHTML = `
      <span><strong>${p.first_name} ${p.last_name}</strong></span>
      <span>Team: ${p.team || "N/A"}</span>
      <span>Position: ${p.position || "N/A"}</span>
    `;
    container.appendChild(div);
  });
}

// Search functionality
document.getElementById('search').addEventListener('input', (e) => {
  const q = e.target.value.toLowerCase();
  const filtered = allPlayers.filter(p =>
    `${p.first_name} ${p.last_name}`.toLowerCase().includes(q) ||
    (p.team && p.team.toLowerCase().includes(q)) ||
    (p.position && p.position.toLowerCase().includes(q))
  );
  displayPlayers(filtered);
});

// Top performers (example by points)
async function displayTopPerformers() {
  const season = '2025';
  const week = '1';
  try {
    const res = await fetch(`https://api.sleeper.app/v1/stats/nba/${season}/${week}`);
    const stats = await res.json();
    const container = document.getElementById('top-performers');
    const playersWithPoints = stats.filter(s => s.pts);
    playersWithPoints.sort((a,b)=>b.pts - a.pts);
    const top5 = playersWithPoints.slice(0,5);
    container.innerHTML = '';
    top5.forEach(stat=>{
      const player = allPlayers.find(p => p.player_id === stat.player_id);
      if(!player) return;
      const div = document.createElement('div');
      div.className = 'top-card';
      div.innerHTML = `
        <span>${player.first_name} ${player.last_name}</span>
        <span>${player.team}</span>
        <span>${stat.pts} pts | ${stat.reb} reb | ${stat.ast} ast</span>
      `;
      container.appendChild(div);
    });
  } catch(err){ console.error(err); }
}

// Fetch recent games
async function fetchGames() {
  try {
    const res = await fetch('https://api.sleeper.app/v1/state/nba');
    const data = await res.json();
    const container = document.getElementById('games');
    container.innerHTML = '';
    data.nba_games.slice(-6).forEach(game=>{
      const div = document.createElement('div');
      div.className = 'card';
      div.innerHTML = `
        <span>${game.home_team} ${game.home_score}</span>
        <span>${game.away_team} ${game.away_score}</span>
        <span>Status: ${game.status}</span>
      `;
      container.appendChild(div);
    });
  } catch(err){ console.error(err); }
}

// Fetch teams
async function fetchTeams() {
  try {
    const res = await fetch('https://api.sleeper.app/v1/teams/nba');
    const teams = await res.json();
    allTeams = teams;
    const container = document.getElementById('teams');
    container.innerHTML = '';
    Object.values(teams).forEach(team=>{
      const div = document.createElement('div');
      div.className = 'card';
      div.innerHTML = `
        <span>${team.full_name} (${team.abbr})</span>
        <span>Conf: ${team.conference} | Div: ${team.division}</span>
      `;
      container.appendChild(div);
    });
  } catch(err){ console.error(err); }
}

// Display standings (dummy wins/losses if not available)
function displayStandings() {
  const container = document.getElementById('standings');
  container.innerHTML = '';
  Object.values(allTeams).forEach(team=>{
    const div = document.createElement('div');
    div.className = 'card';
    div.textContent = `${team.full_name} | ${team.wins || 0}-${team.losses || 0}`;
    container.appendChild(div);
  });
}

// Initialize site
fetchPlayers();
displayTopPerformers();
fetchGames();
fetchTeams();
displayStandings();
</script>

</body>
</html>
