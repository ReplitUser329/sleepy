<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>NBA Info Hub</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #121212;
      color: #fff;
      margin: 0;
      padding: 20px;
    }
    h1, h2 {
      text-align: center;
      color: #ff69b4;
      margin-bottom: 15px;
    }
    #search {
      display: block;
      margin: 0 auto 30px auto;
      padding: 10px;
      width: 300px;
      border-radius: 5px;
      border: none;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap: 15px;
      margin-bottom: 30px;
    }
    .card {
      background: #00ffff20;
      border-radius: 15px;
      padding: 15px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      transition: transform 0.2s;
      cursor: pointer;
    }
    .card:hover {
      transform: scale(1.05);
      background: #00ffff40;
    }
    .top-card {
      background: #ff69b420;
      font-weight: bold;
      padding: 15px;
      border-radius: 15px;
      text-align: center;
      cursor: default;
    }
    .card span {
      margin: 5px 0;
    }
    .section {
      margin-bottom: 40px;
    }
    .sortable-header {
      cursor: pointer;
      text-decoration: underline;
    }
    #player-details {
      position: fixed;
      top: 10%;
      left: 50%;
      transform: translateX(-50%);
      background: #121212;
      border: 2px solid #ff69b4;
      border-radius: 15px;
      padding: 20px;
      z-index: 1000;
      max-width: 600px;
      max-height: 80%;
      overflow-y: auto;
      display: none;
    }
    #player-details h3 {
      text-align: center;
      color: #ff69b4;
    }
    #close-details {
      cursor: pointer;
      color: #ff69b4;
      text-align: right;
      font-weight: bold;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>

<h1>NBA Info Hub</h1>
<input type="text" id="search" placeholder="Search players, teams, or positions">

<div class="section">
  <h2>Top Performers</h2>
  <div id="top-performers" class="grid"></div>
</div>

<div class="section">
  <h2>Recent Games</h2>
  <div id="games" class="grid"></div>
</div>

<div class="section">
  <h2>All Players</h2>
  <div id="players" class="grid"></div>
</div>

<div class="section">
  <h2>Teams</h2>
  <div id="teams" class="grid"></div>
</div>

<div class="section">
  <h2>Standings <span class="sortable-header" id="sort-standings">Sort by Wins</span></h2>
  <div id="standings" class="grid"></div>
</div>

<div class="section">
  <h2>NBA News</h2>
  <div id="news" class="grid"></div>
</div>

<!-- Player details modal -->
<div id="player-details">
  <div id="close-details">Close âœ–</div>
  <h3 id="player-name"></h3>
  <div id="player-stats"></div>
</div>

<script>
let allPlayers = [];
let allTeams = {};
let standingsSorted = false;

// Fetch NBA players
async function fetchPlayers() {
  try {
    const res = await fetch('https://api.sleeper.app/v1/players/nba');
    const data = await res.json();
    allPlayers = Object.values(data)
      .filter(p => p.first_name && p.last_name)
      .sort((a,b)=> a.last_name.localeCompare(b.last_name));
    displayPlayers(allPlayers);
  } catch(err){ console.error(err); }
}

// Display players grid
function displayPlayers(players) {
  const container = document.getElementById('players');
  container.innerHTML = '';
  players.forEach(p => {
    const div = document.createElement('div');
    div.className = 'card';
    div.innerHTML = `
      <span><strong>${p.first_name} ${p.last_name}</strong></span>
      <span>Team: ${p.team || "N/A"}</span>
      <span>Position: ${p.position || "N/A"}</span>
    `;
    div.addEventListener('click', ()=> showPlayerDetails(p));
    container.appendChild(div);
  });
}

// Search players
document.getElementById('search').addEventListener('input', (e)=>{
  const q = e.target.value.toLowerCase();
  const filtered = allPlayers.filter(p =>
    `${p.first_name} ${p.last_name}`.toLowerCase().includes(q) ||
    (p.team && p.team.toLowerCase().includes(q)) ||
    (p.position && p.position.toLowerCase().includes(q))
  );
  displayPlayers(filtered);
});

// Top performers
async function displayTopPerformers() {
  try {
    const res = await fetch('https://api.sleeper.app/v1/stats/nba/2025/1');
    const stats = await res.json();
    const container = document.getElementById('top-performers');
    const topPlayers = stats.filter(s=>s.pts).sort((a,b)=>b.pts - a.pts).slice(0,5);
    container.innerHTML = '';
    topPlayers.forEach(stat=>{
      const player = allPlayers.find(p => p.player_id === stat.player_id);
      if(!player) return;
      const div = document.createElement('div');
      div.className = 'top-card';
      div.innerHTML = `
        <span>${player.first_name} ${player.last_name}</span>
        <span>${player.team}</span>
        <span>${stat.pts} pts | ${stat.reb} reb | ${stat.ast} ast</span>
      `;
      container.appendChild(div);
    });
  } catch(err){ console.error(err); }
}

// Recent games
async function fetchGames() {
  try {
    const res = await fetch('https://api.sleeper.app/v1/state/nba');
    const data = await res.json();
    const container = document.getElementById('games');
    container.innerHTML = '';
    data.nba_games.slice(-6).forEach(game=>{
      const div = document.createElement('div');
      div.className = 'card';
      div.innerHTML = `
        <span>${game.home_team} ${game.home_score}</span>
        <span>${game.away_team} ${game.away_score}</span>
        <span>Status: ${game.status}</span>
      `;
      container.appendChild(div);
    });
  } catch(err){ console.error(err); }
}

// Fetch teams
async function fetchTeams() {
  try {
    const res = await fetch('https://api.sleeper.app/v1/teams/nba');
    const teams = await res.json();
    allTeams = teams;
    const container = document.getElementById('teams');
    container.innerHTML = '';
    Object.values(teams).forEach(team=>{
      const div = document.createElement('div');
      div.className = 'card';
      div.innerHTML = `
        <span>${team.full_name} (${team.abbr})</span>
        <span>Conf: ${team.conference} | Div: ${team.division}</span>
      `;
      container.appendChild(div);
    });
    displayStandings();
  } catch(err){ console.error(err); }
}

// Standings
function displayStandings() {
  const container = document.getElementById('standings');
  container.innerHTML = '';
  let teamsArray = Object.values(allTeams);
  if(standingsSorted){
    teamsArray.sort((a,b)=>(b.wins||0)-(a.wins||0));
  }
  teamsArray.forEach(team=>{
    const div = document.createElement('div');
    div.className = 'card';
    div.textContent = `${team.full_name} | ${team.wins||0}-${team.losses||0}`;
    container.appendChild(div);
  });
}

// Toggle sort standings
document.getElementById('sort-standings').addEventListener('click', ()=>{
  standingsSorted = !standingsSorted;
  displayStandings();
});

// NBA news (replace YOUR_NEWSAPI_KEY with free NewsAPI key)
async function fetchNews() {
  try {
    const res = await fetch('https://newsapi.org/v2/top-headlines?category=sports&q=NBA&apiKey=YOUR_NEWSAPI_KEY&pageSize=6');
    const data = await res.json();
    const container = document.getElementById('news');
    container.innerHTML = '';
    data.articles.forEach(article=>{
      const div = document.createElement('div');
      div.className = 'card';
      div.innerHTML = `
        <span><strong>${article.title}</strong></span>
        <span>${article.source.name}</span>
        <a href="${article.url}" target="_blank" style="color:#ff69b4;">Read</a>
      `;
      container.appendChild(div);
    });
  } catch(err){ console.error(err); }
}

// Show player stats in modal
async function showPlayerDetails(player){
  const modal = document.getElementById('player-details');
  const name = document.getElementById('player-name');
  const statsDiv = document.getElementById('player-stats');
  name.textContent = `${player.first_name} ${player.last_name}`;
  statsDiv.innerHTML = 'Loading stats...';

  try {
    const res = await fetch(`https://api.sleeper.app/v1/stats/nba/2025/1`);
    const stats = await res.json();
    const playerStats = stats.filter(s=>s.player_id === player.player_id);
    if(playerStats.length === 0){
      statsDiv.innerHTML = '<span>No stats available.</span>';
    } else {
      statsDiv.innerHTML = '';
      playerStats.forEach(s=>{
        const div = document.createElement('div');
        div.className = 'card';
        div.innerHTML = `
          <span>PTS: ${s.pts || 0}</span>
          <span>REB: ${s.reb || 0}</span>
          <span>AST: ${s.ast || 0}</span>
          <span>STL: ${s.stl || 0}</span>
          <span>BLK: ${s.blk || 0}</span>
        `;
        statsDiv.appendChild(div);
      });
    }
    modal.style.display = 'block';
  } catch(err){ statsDiv.innerHTML = 'Error loading stats'; console.error(err); }
}

// Close player details
document.getElementById('close-details').addEventListener('click', ()=>{
  document.getElementById('player-details').style.display = 'none';
});

// Initialize all
fetchPlayers();
displayTopPerformers();
fetchGames();
fetchTeams();
fetchNews();
</script>

</body>
</html>
